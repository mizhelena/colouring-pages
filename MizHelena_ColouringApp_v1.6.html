<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Yiayia & Sienna’s Colouring Fun</title>
<style>
html,body{
  margin:0;font-family:'Poppins',system-ui,sans-serif;
  background:linear-gradient(135deg,#ffeaf5,#e6f4ff,#fff5fb);color:#333;
}
header{text-align:center;padding:12px 0;}
header h1{margin:0;font-size:1.9rem;line-height:1.3;text-align:center;}
#toolbar{
  display:flex;justify-content:center;align-items:center;flex-wrap:wrap;
  background:rgba(255,255,255,0.9);padding:8px;gap:10px;
  box-shadow:0 2px 6px rgba(0,0,0,.1);position:sticky;top:0;z-index:10;
}
button{
  border:none;border-radius:12px;background:white;padding:8px 14px;font-size:.9rem;cursor:pointer;color:#333;
  box-shadow:0 2px 5px rgba(0,0,0,.1);transition:.2s;
}
button:hover{transform:translateY(-2px);box-shadow:0 4px 8px rgba(0,0,0,.15);}
button.active{background:#ffe4f0;font-weight:bold;}
.sizegroup{display:flex;align-items:center;gap:8px;background:white;border-radius:12px;
  padding:6px 10px;box-shadow:0 2px 5px rgba(0,0,0,.1);}
.sizegroup input[type=range]{width:140px}
#palette{display:flex;flex-wrap:wrap;justify-content:center;gap:6px;margin:10px;}
.color{width:28px;height:28px;border-radius:50%;border:2px solid white;box-shadow:0 1px 3px rgba(0,0,0,.2);cursor:pointer;}
#thumbs{display:flex;justify-content:center;flex-wrap:wrap;gap:6px;margin-bottom:10px;}
#thumbs img{width:110px;border-radius:6px;cursor:pointer;box-shadow:0 2px 5px rgba(0,0,0,.15);transition:.2s;}
#thumbs img:hover{transform:scale(1.05);}
.canvas-wrap{position:relative;width:min(800px,95vw);margin:20px auto;overflow:visible;
  transform-origin:center center;transition:transform .1s ease-out;will-change:transform;}
#bgCanvas{
  display:block;width:100%;height:auto;border-radius:10px;background:white;
  box-shadow:0 2px 6px rgba(0,0,0,.15);
}
#paintCanvas{
  position:absolute;inset:0;width:100%;height:100%;
  border-radius:10px;touch-action:none;
}
#stickers{display:flex;justify-content:center;gap:10px;flex-wrap:wrap;margin-bottom:20px;}
#stickers img{width:60px;height:60px;cursor:pointer;border-radius:10px;transition:transform .2s;box-shadow:0 2px 5px rgba(0,0,0,.1);}
#stickers img:hover{transform:scale(1.1);}
footer{text-align:center;font-size:.9rem;color:#666;padding:14px 0 24px;}
footer a{color:#888;text-decoration:none;} footer a:hover{text-decoration:underline;}
</style>
</head>
<body>
<header><h1>🖍️🌈 Yiayia & Sienna’s Colouring Fun</h1></header>

<div id="toolbar">
 <button id="drawBtn" class="active">🖍️ Draw</button>
 <button id="stickerBtn">🌸 Sticker</button>
 <button id="eraseBtn">🩹 Erase</button>
 <button id="clearBtn">🧼 Clear</button>
 <button id="saveBtn">💾 Save</button>
 <div class="sizegroup">
   <label for="size">🖌️ Size</label>
   <input id="size" type="range" min="2" max="48" value="12">
 </div>
</div>

<!-- 🎨 Colour Palette -->
<div id="palette"></div>

<!-- 📖 Thumbnails -->
<div id="thumbs">
 <img src="page1.png"><img src="page2.png"><img src="page3.png">
 <img src="page4.png"><img src="page5.png"><img src="page6.png">
</div>

<!-- 🖼️ Main Canvas -->
<div class="canvas-wrap" id="canvasWrap">
  <canvas id="bgCanvas" width="800" height="800"></canvas>
  <canvas id="paintCanvas" width="800" height="800"></canvas>
</div>

<!-- 🌸 Stickers -->
<div id="stickers">
 <img crossorigin="anonymous" src="https://cdn.jsdelivr.net/gh/twitter/twemoji@14.0.2/assets/72x72/2764.png" alt="heart">
 <img crossorigin="anonymous" src="https://cdn.jsdelivr.net/gh/twitter/twemoji@14.0.2/assets/72x72/2b50.png" alt="star">
 <img crossorigin="anonymous" src="https://cdn.jsdelivr.net/gh/twitter/twemoji@14.0.2/assets/72x72/1f33c.png" alt="flower">
 <img crossorigin="anonymous" src="https://cdn.jsdelivr.net/gh/twitter/twemoji@14.0.2/assets/72x72/1f98b.png" alt="butterfly">
 <img crossorigin="anonymous" src="https://cdn.jsdelivr.net/gh/twitter/twemoji@14.0.2/assets/72x72/1f308.png" alt="rainbow">
</div>

<footer>
 Made with ❤️ by Miz Helena Children’s Books ·
 <a href="https://mizhelenabooks.com.au" target="_blank">mizhelenabooks.com.au</a>
</footer>

<script>
const bgCanvas=document.getElementById("bgCanvas");
const paintCanvas=document.getElementById("paintCanvas");
const bgCtx=bgCanvas.getContext("2d");
const ctx=paintCanvas.getContext("2d");
let drawing=false,color="#000",size=12,mode="draw",selectedSticker=null;

// 🎨 COLOUR PALETTE
(function(){
 const colours=["#e74c3c","#e67e22","#f1c40f","#2ecc71","#3498db","#9b59b6","#ff8bd6","#ffffff",
 "#7f8c8d","#808000","#ffd700","#ff7f50","#dda0dd","#5dade2","#2c3e50","#8b4513","#f5deb3",
 "#708090","#ffc0cb","#b0e0e6","#f8c8dc","#9370db","#fff176","#ffb347","#90ee90","#e0e0e0",
 "#87cefa","#b39ddb","#ffcc80","#ffb6c1"];
 const p=document.getElementById("palette");
 colours.forEach(c=>{
   const d=document.createElement("div");
   d.className="color";
   d.style.background=c;
   d.onclick=()=>color=c;
   p.appendChild(d);
 });
})();

// 🖼️ IMAGE LOADING
function loadImage(src){
 const i=new Image();
 i.crossOrigin="anonymous";
 i.onload=()=>{
   console.log("✅ Image loaded:", src);
   bgCtx.clearRect(0,0,bgCanvas.width,bgCanvas.height);
   bgCtx.drawImage(i,0,0,bgCanvas.width,bgCanvas.height);
 };
 i.onerror=()=>console.error("❌ Image failed:", src);
 i.src=src;
}
window.addEventListener("load",()=>loadImage("page1.png"));
document.querySelectorAll("#thumbs img").forEach(img=>{img.onclick=()=>loadImage(img.src);});

// ✏️ DRAWING + ERASING
document.getElementById("size").oninput=e=>size=parseInt(e.target.value,10);
function pos(e){
 const r=paintCanvas.getBoundingClientRect();
 const sx=paintCanvas.width/r.width,sy=paintCanvas.height/r.height;
 return {x:(e.clientX-r.left)*sx,y:(e.clientY-r.top)*sy};
}
paintCanvas.onpointerdown=e=>{
 const p=pos(e);
 if(mode==="draw"||mode==="erase"){drawing=true;ctx.beginPath();ctx.moveTo(p.x,p.y);}
 else if(mode==="sticker"&&selectedSticker){
   const s=new Image();s.crossOrigin="anonymous";s.src=selectedSticker;
   s.onload=()=>ctx.drawImage(s,p.x-30,p.y-30,60,60);
 }};
paintCanvas.onpointermove=e=>{
 if(drawing&&(mode==="draw"||mode==="erase")){
   ctx.lineWidth=size;ctx.lineCap="round";
   ctx.globalCompositeOperation=(mode==="erase")?"destination-out":"source-over";
   if(mode!=="erase")ctx.strokeStyle=color;
   const p=pos(e);ctx.lineTo(p.x,p.y);ctx.stroke();ctx.beginPath();ctx.moveTo(p.x,p.y);
 }};
paintCanvas.onpointerup=()=>{drawing=false;ctx.beginPath();ctx.globalCompositeOperation="source-over";};

// 🧼 CLEAR
document.getElementById("clearBtn").onclick=()=>ctx.clearRect(0,0,paintCanvas.width,paintCanvas.height);

// 💾 SAVE
document.getElementById("saveBtn").onclick=()=>{
 const out=document.createElement("canvas");
 out.width=800;out.height=800;
 const o=out.getContext("2d");
 o.drawImage(bgCanvas,0,0);
 o.drawImage(paintCanvas,0,0);
 out.toBlob(b=>{
   const u=URL.createObjectURL(b);
   const a=document.createElement("a");
   a.href=u;a.download="Yiayia_Sienna_Artwork.png";
   document.body.appendChild(a);a.click();a.remove();
   setTimeout(()=>URL.revokeObjectURL(u),1000);
 });
};

// 🌸 STICKERS
document.querySelectorAll("#stickers img").forEach(st=>{
 st.onclick=()=>{
   selectedSticker=st.src;
   mode="sticker";
   document.querySelectorAll("#toolbar button").forEach(b=>b.classList.remove("active"));
   document.getElementById("stickerBtn").classList.add("active");
 };
});

// 🎚️ ZOOM + PAN
const wrap=document.getElementById("canvasWrap");
let scale=1,originX=0,originY=0,isPanning=false,startX=0,startY=0,lastDist=0;
function apply(){wrap.style.transform=`translate(${originX}px,${originY}px) scale(${scale})`;}

// Desktop scroll zoom
wrap.addEventListener("wheel",e=>{
 e.preventDefault();
 const delta=-e.deltaY*0.001;
 scale=Math.min(Math.max(1,scale+delta),3);
 apply();
},{passive:false});

// Touch pinch + pan
wrap.addEventListener("touchstart",e=>{
 if(e.touches.length===2){
   lastDist=Math.hypot(
     e.touches[0].clientX-e.touches[1].clientX,
     e.touches[0].clientY-e.touches[1].clientY);
 }else if(e.touches.length===1){
   isPanning=true;
   startX=e.touches[0].clientX-originX;
   startY=e.touches[0].clientY-originY;
 }
});
wrap.addEventListener("touchmove",e=>{
 if(e.touches.length===2){
   const d=Math.hypot(
     e.touches[0].clientX-e.touches[1].clientX,
     e.touches[0].clientY-e.touches[1].clientY);
   const diff=d-lastDist;
   scale=Math.min(Math.max(1,scale+diff*0.005),3);
   lastDist=d;
   apply();
 }else if(e.touches.length===1&&isPanning){
   originX=e.touches[0].clientX-startX;
   originY=e.touches[0].clientY-startY;
   apply();
 }},{passive:false});
wrap.addEventListener("touchend",()=>isPanning=false);
</script>
</body>
</html>
